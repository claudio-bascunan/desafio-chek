{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction HomeComponent_tr_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const log_r1 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(log_r1.date_time);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(log_r1.status);\n  }\n}\nexport let HomeComponent = /*#__PURE__*/(() => {\n  class HomeComponent {\n    constructor(router) {\n      this.router = router;\n      // Variables para almacenar datos ingresados por el usuario y preestablecidos\n      this.firstname = null;\n      this.logs = [];\n      this.sessionTimeout = 5 * 60 * 1000; // Tiempo: 5 minutos\n      this.isPageReloading = false;\n      this.currentPage = 1;\n      this.pageSize = 10;\n      this.totalPages = 1;\n    }\n    // Función que se ejecuta al iniciar el componente\n    ngOnInit() {\n      // Detecta cuando se cierra una pagina o se recarga\n      window.addEventListener('unload', () => {\n        if (!this.isPageReloading) {\n          this.logout();\n        }\n      });\n      // Detecta cuando se presiona una tecla\n      window.addEventListener('keydown', event => {\n        if (event.key === 'F5') {\n          this.isPageReloading = true;\n        }\n        this.onActivity();\n      });\n      // Detecta cuando se hace clic\n      window.addEventListener('click', () => {\n        this.onActivity();\n      });\n      // Obtiene el token almacenado en localStorage\n      const token = localStorage.getItem('access_token');\n      // Si el token tiene valor 'true' va a extraer su información, en este caso el Nombre (firstname) y el historial de acceso (logs)\n      if (token) {\n        const tokenData = JSON.parse(atob(token.split('.')[1]));\n        this.firstname = tokenData.firstname;\n        this.logs = tokenData.logs || [];\n      }\n      this.calculateTotalPages();\n      this.startSessionTimeout();\n    }\n    // Función para cerrar sesión\n    logout() {\n      // Elimina el token de localStorage\n      localStorage.removeItem('access_token');\n      //Redirige al login\n      this.router.navigate(['/login']);\n    }\n    // Función que se ejecuta si el usuario está activo\n    onActivity() {\n      clearTimeout(this.timeoutId);\n      this.startSessionTimeout();\n    }\n    // Función que inicia tiempo para cerrar sesión en caso de inactividad\n    startSessionTimeout() {\n      this.timeoutId = setTimeout(() => this.logout(), this.sessionTimeout);\n    }\n    calculateTotalPages() {\n      this.totalPages = Math.ceil(this.logs.length / this.pageSize);\n    }\n    goToPage(pageNumber) {\n      if (pageNumber >= 1 && pageNumber <= this.totalPages) {\n        this.currentPage = pageNumber;\n      }\n    }\n    getPaginatedLogs() {\n      const startIndex = (this.currentPage - 1) * this.pageSize;\n      const endIndex = startIndex + this.pageSize;\n      return this.logs.slice(startIndex, endIndex);\n    }\n  }\n  HomeComponent.ɵfac = function HomeComponent_Factory(t) {\n    return new (t || HomeComponent)(i0.ɵɵdirectiveInject(i1.Router));\n  };\n  HomeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: HomeComponent,\n    selectors: [[\"app-home\"]],\n    decls: 32,\n    vars: 4,\n    consts: [[1, \"container\"], [1, \"button-logout\", 3, \"click\"], [1, \"home-form\"], [1, \"table-container\"], [4, \"ngFor\", \"ngForOf\"], [1, \"pagination\"], [1, \"pagination-item-double\", 3, \"click\"], [\"src\", \"../../assets/left-double-arrow.png\"], [1, \"pagination-item\", 3, \"click\"], [\"src\", \"../../assets/left-arrow.png\"], [\"src\", \"../../assets/right-arrow.png\"], [\"src\", \"../../assets/right-double-arrow.png\"]],\n    template: function HomeComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"button\", 1);\n        i0.ɵɵlistener(\"click\", function HomeComponent_Template_button_click_1_listener() {\n          return ctx.logout();\n        });\n        i0.ɵɵtext(2, \"Cerrar sesi\\u00F3n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"form\", 2)(4, \"div\", 3)(5, \"h1\");\n        i0.ɵɵtext(6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"table\")(8, \"caption\");\n        i0.ɵɵtext(9, \"Historial de acceso\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"thead\")(11, \"tr\")(12, \"th\");\n        i0.ɵɵtext(13, \"Fecha\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"th\");\n        i0.ɵɵtext(15, \"Estado\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(16, \"tbody\");\n        i0.ɵɵtemplate(17, HomeComponent_tr_17_Template, 5, 2, \"tr\", 4);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(18, \"div\", 5)(19, \"div\", 6);\n        i0.ɵɵlistener(\"click\", function HomeComponent_Template_div_click_19_listener() {\n          return ctx.goToPage(1);\n        });\n        i0.ɵɵelement(20, \"img\", 7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"div\", 8);\n        i0.ɵɵlistener(\"click\", function HomeComponent_Template_div_click_21_listener() {\n          return ctx.goToPage(ctx.currentPage - 1);\n        });\n        i0.ɵɵelement(22, \"img\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"span\");\n        i0.ɵɵtext(24);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"div\", 8);\n        i0.ɵɵlistener(\"click\", function HomeComponent_Template_div_click_25_listener() {\n          return ctx.goToPage(ctx.currentPage + 1);\n        });\n        i0.ɵɵelement(26, \"img\", 10);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(27, \"div\", 6);\n        i0.ɵɵlistener(\"click\", function HomeComponent_Template_div_click_27_listener() {\n          return ctx.goToPage(ctx.totalPages);\n        });\n        i0.ɵɵelement(28, \"img\", 11);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(29, \"footer\")(30, \"p\");\n        i0.ɵɵtext(31, \"\\u00A9 Desaf\\u00EDo T\\u00E9cnico Chek Agosto 2023 - Claudio Andr\\u00E9s Bascu\\u00F1\\u00E1n Valdivia\");\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(6);\n        i0.ɵɵtextInterpolate1(\"Bienvenido, \", ctx.firstname, \"!\");\n        i0.ɵɵadvance(11);\n        i0.ɵɵproperty(\"ngForOf\", ctx.getPaginatedLogs());\n        i0.ɵɵadvance(7);\n        i0.ɵɵtextInterpolate2(\"\", ctx.currentPage, \" de \", ctx.totalPages, \"\");\n      }\n    },\n    dependencies: [i2.NgForOf, i3.ɵNgNoValidate, i3.NgControlStatusGroup, i3.NgForm],\n    styles: [\".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:30px;border-radius:8px;background-color:#fff;box-shadow:0 2px 4px #0000001a;max-width:400px;width:100%}.table-container[_ngcontent-%COMP%]{margin-bottom:20px}.title-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.button-logout[_ngcontent-%COMP%]{background-color:#fff;color:#5d3884;border:none;padding:10px 20px;border-radius:4px;cursor:pointer;position:absolute;top:10px;right:10px;font-weight:700}table[_ngcontent-%COMP%]{margin:0 auto;width:auto;background-color:#fff;border-bottom-left-radius:8px;border-bottom-right-radius:8px;box-shadow:0 2px 4px #0000001a;border-collapse:separate;border-spacing:0}th[_ngcontent-%COMP%]{color:#5d3884;padding:10px;text-align:center;border:none;border-bottom:1px solid #e0e0e0;font-family:Arial Rounded MT Bold,sans-serif}td[_ngcontent-%COMP%]{color:#5d3884;padding:10px;text-align:center;border:none;border-top:1px solid #e0e0e0;font-family:Arial,sans-serif}caption[_ngcontent-%COMP%]{padding:10px;font-size:18px;font-weight:700;font-family:Arial,sans-serif;background-color:#ffd54f;border-top-left-radius:8px;border-top-right-radius:8px;caption-side:top}h1[_ngcontent-%COMP%]{color:#371d53;text-align:center;font-family:Arial Rounded MT Bold,sans-serif}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-top:10px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#fff;color:#5d3884;border:none;padding:10px 20px;border-radius:4px;cursor:pointer;margin:5px}.pagination[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:5px;font-size:14px;font-family:Arial,sans-serif}.pagination-item[_ngcontent-%COMP%]{cursor:pointer;padding:5px}.pagination-item-double[_ngcontent-%COMP%]{cursor:pointer;padding:15px}.pagination[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:10px;height:10px}\"]\n  });\n  return HomeComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}